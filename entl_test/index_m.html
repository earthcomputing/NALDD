<!DOCTYPE html>
<html>
<head>
  <!--<meta http-equiv="refresh" content="0;url=index.html">-->
  
  <script src="js/d3.min.js" type="text/Javascript"></script>
  <script src="node_modules/socket.io/node_modules/socket.io-client/socket.io.js" type="text/Javascript"></script>

  <!--<script src="enode-client.js" type="text/Javascript"></script>-->
  <title>Earth Admin</title>
  <!-- <script language="javascript">
       window.location.href = "pages/index.html"
       </script> -->
  <style>
    .entl-device {
    font-family: "Arial Black", sans-serif;
    font-size: 36px;
    }
    
    .UP {
    table-layout: fixed;
    width: 200px;
    background-color: #55FF55;
    bgcolor:#5FF55;
    }
    
    .DOWN {
    table-layout: fixed;
    width: 200px;      
    background-color: #FF5555;
    bgcolor:#FF5555;
    } 
    
    .IDLE {
    background-color: #FF5555;
    bgcolor:#FF5555;
    } 

    .RECEIVE {
    background-color: #55FF55;
    bgcolor:#FF5555;
    } 

    .SEND {
    background-color: #55FF55;
    bgcolor:#FF5555;
    } 
    
    .AM {
    background-color: #55FF55;
    bgcolor:#FF5555;
    } 

    .AH {
    background-color: #55FF55;
    bgcolor:#FF5555;
    } 

    .BM {
    background-color: #55FF55;
    bgcolor:#FF5555;
    } 

    .BH {
    background-color: #55FF55;
    bgcolor:#FF5555;
    } 

    .WAIT {
    background-color: #FFDD00;
    bgcolor:#FF8800;
    }
    
    .HELLO {
    background-color: #FFDD00;
    bgcolor:#FF8800;
    } 
    
  </style>
</head>
<body>
<!--  <div>
    <svg class="DOWN" id="enp2s0" style="height=200px;width=200px" />
    enp2s0
  </div> -->
  <br/>
  <br/>

  <div class="entl-device" >
    <table id="earth-enp6s0" border="1" width="1200" >
      <tr>
	<td bgcolor="#AAAAFF" align="center" width="600" > Device:</td>
	<td id="device-name" align="center"  width="200" > enp6s0 </td>
	<td bgcolor="#AAAAFF" align="center" width="200" > Link:</td>
	<td class="DOWN" colspan="10" id="link-status" align="center" width="200" >DOWN </td>
      </tr>
      <tr>
	<td id="entl-status" class="IDLE" align="center">Idle</td>
	<td id="entl-count" colspan="3" align="right">0</td>
      </tr>
      <tr>
	<td bgcolor="#AAAAFF" align="right"> Send Message via AIT:</td>
   <td colspan="3" align="center">
    <FORM NAME="myform6" ACTION="" METHOD="GET">
      <INPUT TYPE="text" NAME="inputbox" VALUE="">
      <INPUT TYPE="button" NAME="button" Value="send" onClick="sendMessage(this.form, 'enp6s0')">
    </FORM>
  </td>
      </tr>
      <tr>
	<td bgcolor="#AAAAFF" align="right"> Recieved Message via AIT:</td>
	<td id="recieved-message" colspan="3" align="center" >-none-</td>
      </tr>
      </table>
    <!--    <svg class="DOWN" id="earth" style="height=200px;width=200px" />-->
  </div>
  <div class="entl-device" >
    <table id="earth-enp7s0" border="1" width="1200" >
      <tr>
	<td bgcolor="#AAAAFF" align="center" width="600" > Device:</td>
	<td id="device-name" align="center" width="200" > enp7s0 </td>
	<td bgcolor="#AAAAFF" align="center" width="200" > Link:</td>
	<td class="DOWN" id="link-status" align="center" width="200" >DOWN </td>
      </tr>
      <tr>
	<td id="entl-status" class="IDLE" align="center">Idle</td>
	<td id="entl-count" colspan="3" align="right">0</td>
      </tr>
      <tr>
	<td bgcolor="#AAAAFF" align="right"> Send Message via AIT:</td>
  <td colspan="3" align="center">
    <FORM NAME="myform7" ACTION="" METHOD="GET">
      <INPUT TYPE="text" NAME="inputbox" VALUE="">
      <INPUT TYPE="button" NAME="button" Value="send" onClick="sendMessage(this.form, 'enp7s0')">
    </FORM>
  </td>
      </tr>
      <tr>
	<td bgcolor="#AAAAFF" align="right"> Recieved Message via AIT:</td>
	<td id="recieved-message" colspan="3" align="center" >-none-</td>
      </tr>
      </table>
<!--    <svg class="DOWN" id="earth" style="height=200px;width=200px" /> -->
  </div>
  <div class="entl-device" >
    <table id="earth-enp8s0" border="1" width="1200" >
      <tr>
	<td bgcolor="#AAAAFF" align="center" width="600" > Device:</td>
	<td id="device-name" align="center" width="200" > enp8s0 </td>
	<td bgcolor="#AAAAFF" align="center" width="200" > Link:</td>
	<td class="DOWN" id="link-status" align="center" width="200" >DOWN </td>
      </tr>
      <tr>
	<td id="entl-status" class="DOWN" align="center">Idle</td>
	<td id="entl-count" colspan="3" align="right">0</td>
      </tr>
      <tr>
	<td bgcolor="#AAAAFF" align="right"> Send Message via AIT:</td>
  <td colspan="3" align="center">
    <FORM NAME="myform8" ACTION="" METHOD="GET">
      <INPUT TYPE="text" NAME="inputbox" VALUE="">
      <INPUT TYPE="button" NAME="button" Value="send" onClick="sendMessage(this.form, 'enp8s0')">
    </FORM>
  </td>
      </tr>
      <tr>
	<td bgcolor="#AAAAFF" align="right"> Recieved Message via AIT:</td>
	<td id="recieved-message" colspan="3" align="center" >-none-</td>
      </tr>
      </table>
<!--    <svg class="DOWN" id="earth" style="height=200px;width=200px" /> -->
  </div>
  <div class="entl-device" >
    <table id="earth-enp9s0" border="1" width="1200" >
      <tr>
	<td bgcolor="#AAAAFF" align="center" width="600" > Device:</td>
	<td id="device-name" align="center" width="200" > enp9s0 </td>
	<td bgcolor="#AAAAFF" align="center" width="200" > Link:</td>
	<td class="DOWN" id="link-status" align="center" width="200" >DOWN </td>
      </tr>
      <tr>
	<td id="entl-status" class="IDLE" align="center">IDLE</td>
	<td id="entl-count" colspan="3" align="right">0</td>
      </tr>
      <tr>
	<td bgcolor="#AAAAFF" align="right"> Send Message via AIT:</td>
	  <td colspan="3" align="center">
    <FORM NAME="myform9" ACTION="" METHOD="GET">
      <INPUT TYPE="text" NAME="inputbox" VALUE="">
      <INPUT TYPE="button" NAME="button" Value="send" onClick="sendMessage(this.form, 'enp9s0')">
    </FORM>
    </td>
      </tr>
      <tr>
	<td bgcolor="#AAAAFF" align="right"> Recieved Message via AIT:</td>
	<td id="recieved-message" colspan="3" align="right" >-none-</td>
      </tr>
      </table>
<!--    <svg class="DOWN" id="earth" style="height=200px;width=200px" />-->
  </div>
  <script type="text/Javascript">
    
   // <!---d3.select("#enp2s0").append("circle").attr("r", 50).attr("cx",150).attr("cy", 75).style("stroke", "black").style("stroke-width", "2px").style("fill", "blue");
   // d3.select("#earth").append("circle").attr("r", 50).attr("cx",150).attr("cy", 75).style("stroke", "black").style("stroke-width", "2px").style("fill", "red");-->

    var socket = io();

    console.log(socket);
    
    //$('form').submit(function(){
    //    socket.emit('ait message', $('#m').val());
    //    $('#m').val('');
    //    return false;
    //});

    socket.on("enp2s0-update", function(data) {
    console.log(data);
    d3.select("#enp2s0").attr("class", data.linkState);
    });

   socket.on("earth-update", function(data) {
    data = data.toString();
    data = JSON.parse(data) ;

    console.log(data.AITRecieved);
   
    d3.select("#earth-"+data.deviceName).select("#device-name").text(data.deviceName);
    d3.select("#earth-"+data.deviceName).select("#link-status").attr("class", data.linkState);
    d3.select("#earth-"+data.deviceName).select("#link-status").text(data.linkState);
    d3.select("#earth-"+data.deviceName).select("#entl-status").attr("class", data.entlState);
    d3.select("#earth-"+data.deviceName).select("#entl-status").text(data.entlState);
    d3.select("#earth-"+data.deviceName).select("#entl-count").text(data.entlCount);

    d3.select("#earth-"+data.deviceName).select("#recieved-message").text(data.AITRecieved);
   });

   function sendMessage(formi, i) {
    var message = formi.inputbox.value ;
    formi.inputbox.value = '' ;
   var data = {"message": message, "port" : i};
   console.log(data);
   console.log(socket);
   socket.emit("aitMessage", data);
   }  
</script>
</body>
</html>
